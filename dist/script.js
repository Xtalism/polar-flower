var canvas,pNumSlider,pLenSlider,diameterSlider,pSharpSlider,petalNum,pLength,diameter,pSharpness,heightSlider,curvatureSlider1,curvatureSlider2,flowerHeight,curvature1,curvature2,bumpSlider,bumpNumSlider,bump,bumpNum,pNum,fD,pLen,pSharp,fHeight,curve1,curve2,b,bNum,v=[],rows=30,cols=90,angle=0;function setup(){(canvas=createCanvas(850,850,WEBGL)).class("canvas"),colorMode(HSB,360,100,100),angleMode(DEGREES),noStroke(),(petalNum=createDiv()).class("valueDisplay"),(pNumSlider=createSlider(1,20,5,1)).class("Slider"),(diameter=createDiv()).class("valueDisplay"),(diameterSlider=createSlider(20,250,180,10)).class("Slider"),(pLength=createDiv()).class("valueDisplay"),(pLenSlider=createSlider(0,300,60,10)).class("Slider"),(pSharpness=createDiv()).class("valueDisplay"),(pSharpSlider=createSlider(0,10,.4,.1)).class("Slider"),(flowerHeight=createDiv()).class("valueDisplay"),(heightSlider=createSlider(0,600,300,10)).class("Slider"),(curvature1=createDiv()).class("valueDisplay"),(curvatureSlider1=createSlider(0,4,.6,.1)).class("Slider"),(curvature2=createDiv()).class("valueDisplay"),(curvatureSlider2=createSlider(0,1,.2,.05)).class("Slider"),(bump=createDiv()).class("valueDisplay"),(bumpSlider=createSlider(0,5,3.5,.5)).class("Slider"),(bumpNum=createDiv()).class("valueDisplay"),(bumpNumSlider=createSlider(0,20,4,1)).class("Slider")}function draw(){for(clear(),orbitControl(4,4),rotateX(40),rotateZ(angle),angle+=1,pNum=pNumSlider.value(),fD=diameterSlider.value(),pLen=pLenSlider.value(),pSharp=pSharpSlider.value(),fHeight=heightSlider.value(),curve1=curvatureSlider1.value(),curve2=curvatureSlider2.value(),b=bumpSlider.value(),bNum=bumpNumSlider.value(),theta=0;theta<rows;theta+=1){v.push([]);for(var phi=0;phi<cols;phi+=1){var r=(pLen*pow(abs(sin(pNum/2*phi*360/cols)),pSharp)+fD)*theta/rows,x=r*cos(360*phi/cols),y=r*sin(360*phi/cols),r=vShape(fHeight,r/100,curve1,curve2,1.5)-200+bumpiness(b,r/100,bNum,360*phi/cols),x=createVector(x,y,r);v[theta].push(x)}}for(var _theta=0;_theta<v.length;_theta++)for(var _phi=0;_phi<v[_theta].length;_phi++)fill(50,90,105-2*_theta),_theta<v.length-1&&_phi<v[_theta].length-1?(beginShape(),vertex(v[_theta][_phi].x,v[_theta][_phi].y,v[_theta][_phi].z),vertex(v[_theta+1][_phi].x,v[_theta+1][_phi].y,v[_theta+1][_phi].z),vertex(v[_theta+1][_phi+1].x,v[_theta+1][_phi+1].y,v[_theta+1][_phi+1].z),vertex(v[_theta][_phi+1].x,v[_theta][_phi+1].y,v[_theta][_phi+1].z),endShape(CLOSE)):_theta<v.length-1&&_phi==v[_theta].length-1&&(beginShape(),vertex(v[_theta][_phi].x,v[_theta][_phi].y,v[_theta][_phi].z),vertex(v[_theta][0].x,v[_theta][0].y,v[_theta][0].z),vertex(v[_theta+1][0].x,v[_theta+1][0].y,v[_theta+1][0].z),vertex(v[_theta+1][_phi].x,v[_theta+1][_phi].y,v[_theta+1][_phi].z),endShape(CLOSE));petalNum.html("Number of the petals: "+pNumSlider.value()),diameter.html("Diameter: "+diameterSlider.value()),pLength.html("Petal Length: "+pLenSlider.value()),pSharpness.html("Petal Sharpness: "+pSharpSlider.value()),flowerHeight.html("Flower height: "+heightSlider.value()),curvature1.html("Curvature 1: "+curvatureSlider1.value()),curvature2.html("Curvature 2: "+curvatureSlider2.value()),bump.html("Bumpiness: "+bumpSlider.value()),bumpNum.html("Bumpiness: "+bumpNumSlider.value()),v=[]}function vShape(A,r,a,b,c){return A*pow(Math.E,-b*pow(abs(r),c))*pow(abs(r),a)}function bumpiness(A,r,f,angle){return 1+A*pow(r,2)*sin(f*angle)}